<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mom's Recipe Box</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Georgia', serif;
      background: linear-gradient(135deg, #fef9f3 0%, #f5ebe0 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    h1 {
      font-size: 2.5rem;
      color: #5c4033;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    }
    
    h1 span { font-size: 1.5rem; }
    
    .subtitle {
      color: #8b7355;
      font-style: italic;
      margin-top: 5px;
    }
    
    .actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    
    .btn {
      background: linear-gradient(135deg, #c41e3a 0%, #8b0000 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 25px;
      font-family: inherit;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(196, 30, 58, 0.3);
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(196, 30, 58, 0.4);
    }
    
    .btn:disabled {
      background: #ccc;
      box-shadow: none;
      cursor: not-allowed;
      transform: none;
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, #2e8b57 0%, #1a5235 100%);
      box-shadow: 0 4px 15px rgba(46, 139, 87, 0.3);
    }
    
    .btn-secondary:hover {
      box-shadow: 0 6px 20px rgba(46, 139, 87, 0.4);
    }
    
    .recipe-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .recipe-card {
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
    }
    
    .recipe-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    }
    
    .recipe-card.selected {
      outline: 4px solid #c41e3a;
    }
    
    .recipe-card.expanded {
      /* removed - no longer expanding */
    }
    
    .card-header {
      background: linear-gradient(135deg, #8b4513 0%, #5c4033 100%);
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-header h2 {
      font-size: 1.4rem;
    }
    
    .card-header .from {
      font-size: 0.85rem;
      opacity: 0.9;
      font-style: italic;
    }
    
    .checkbox {
      width: 28px;
      height: 28px;
      border: 3px solid white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      transition: all 0.2s;
    }
    
    .recipe-card.selected .checkbox {
      background: white;
    }
    
    .checkbox::after {
      content: '‚úì';
      color: #5c4033;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .recipe-card.selected .checkbox::after {
      opacity: 1;
    }
    
    .card-preview {
      padding: 20px;
      color: #5c4033;
    }
    
    .card-preview p {
      margin-bottom: 10px;
      line-height: 1.5;
    }
    
    .expand-hint {
      color: #c41e3a;
      font-size: 0.9rem;
      font-style: italic;
    }
    
    .card-details {
      display: none;
    }
    
    /* Recipe Detail Modal */
    .recipe-modal {
      background: white;
      border-radius: 20px;
      max-width: 550px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .recipe-modal .modal-header {
      background: linear-gradient(135deg, #8b4513 0%, #5c4033 100%);
    }
    
    .recipe-modal .modal-body {
      padding: 25px;
    }
    
    .recipe-modal .from-line {
      font-style: italic;
      color: #8b7355;
      margin-bottom: 20px;
      font-size: 1rem;
    }
    
    .recipe-modal h3 {
      color: #5c4033;
      margin: 20px 0 12px;
      font-size: 1.2rem;
      border-bottom: 2px solid #f5ebe0;
      padding-bottom: 5px;
    }
    
    .recipe-modal ul, .recipe-modal ol {
      margin-left: 25px;
      color: #444;
      line-height: 2;
    }
    
    .recipe-modal li {
      margin-bottom: 5px;
    }
    
    .recipe-tip {
      background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      border-left: 4px solid #ffc107;
    }
    
    .recipe-tip strong { color: #856404; }
    
    /* Shopping List Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.6);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    .modal-overlay.active {
      display: flex;
    }
    
    .modal {
      background: white;
      border-radius: 20px;
      max-width: 500px;
      width: 100%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .modal-header {
      background: linear-gradient(135deg, #2e8b57 0%, #1a5235 100%);
      color: white;
      padding: 20px;
      border-radius: 20px 20px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
    }
    
    .modal-header h2 { font-size: 1.5rem; }
    
    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 2rem;
      cursor: pointer;
      line-height: 1;
    }
    
    .modal-body {
      padding: 20px;
    }
    
    .shopping-category {
      margin-bottom: 20px;
    }
    
    .shopping-category h3 {
      color: #2e8b57;
      border-bottom: 2px solid #2e8b57;
      padding-bottom: 5px;
      margin-bottom: 10px;
    }
    
    .shopping-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px dotted #eee;
    }
    
    .shopping-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      accent-color: #2e8b57;
    }
    
    .shopping-item label {
      flex: 1;
      color: #333;
    }
    
    .shopping-item .recipe-tags {
      font-size: 0.75rem;
      color: #888;
    }
    
    .shopping-item.checked label {
      text-decoration: line-through;
      color: #aaa;
    }
    
    .print-btn {
      width: 100%;
      margin-top: 20px;
    }
    
    .recipes-included {
      background: #f5f5f5;
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.9rem;
      color: #666;
    }
    
    .recipes-included strong { color: #5c4033; }
    
    @media print {
      body { background: white; }
      .modal-overlay { position: static; background: none; }
      .modal { box-shadow: none; max-height: none; }
      .close-btn, .print-btn, .actions { display: none; }
      .shopping-item input[type="checkbox"] { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
    }
    
    @media (max-width: 600px) {
      h1 { font-size: 1.8rem; }
      h1 span { font-size: 1.2rem; }
      .card-header h2 { font-size: 1.2rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üç™ Mom's Recipe Box <span>‚ú®</span></h1>
      <p class="subtitle">Christmas Favorites from Barb Creamer's Kitchen</p>
    </header>
    
    <div class="actions">
      <button class="btn btn-secondary" id="shoppingBtn" disabled>
        üõí Make Shopping List (<span id="selectedCount">0</span> selected)
      </button>
      <button class="btn" id="selectAllBtn">Select All</button>
    </div>
    
    <div class="recipe-grid" id="recipeGrid"></div>
  </div>
  
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h2>üõí Shopping List</h2>
        <button class="close-btn" id="closeModal">&times;</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>
  
  <div class="modal-overlay" id="recipeModalOverlay">
    <div class="recipe-modal">
      <div class="modal-header">
        <h2 id="recipeModalTitle">Recipe</h2>
        <button class="close-btn" id="closeRecipeModal">&times;</button>
      </div>
      <div class="modal-body" id="recipeModalBody"></div>
    </div>
  </div>

  <script>
    const recipes = [
      {
        id: 'oreo-truffle',
        name: 'Oreo Truffle',
        from: 'Barb Everard',
        preview: 'Crushed Oreos mixed with cream cheese, dipped in chocolate. Dangerously addictive!',
        ingredients: [
          { item: 'Oreo cookies', amount: '1 package', category: 'Snacks' },
          { item: 'Cream cheese', amount: '8 oz, softened', category: 'Dairy' },
          { item: 'Semi-sweet baking chocolate', amount: '2 (8 oz) bars', category: 'Baking' },
          { item: 'Dipping chocolate', amount: '1 package', category: 'Baking' }
        ],
        directions: [
          'Keep 5 cookies to crush for topping',
          'Crush remaining cookies in food processor',
          'Add softened cream cheese and mix well',
          'Roll into 1" balls',
          'Dip in melted chocolate',
          'Sprinkle with topping',
          'Set up in freezer',
          'Use cookie sheet & parchment paper'
        ],
        tip: 'Topping ideas: Crushed candy canes, toffee bits, Andes mints, toasted almonds, crushed Oreos, or flaked coconut!'
      },
      {
        id: 'pecan',
        name: 'Pecan Balls',
        from: 'Barb Everard',
        preview: 'Buttery melt-in-your-mouth cookies rolled in powdered sugar. A holiday classic!',
        ingredients: [
          { item: 'Flour', amount: '1 cup', category: 'Baking' },
          { item: 'Butter', amount: '¬Ω cup, softened', category: 'Dairy' },
          { item: 'Pecans', amount: '1 cup, chopped', category: 'Nuts' },
          { item: 'Sugar', amount: '2 T', category: 'Baking' },
          { item: 'Salt', amount: '‚Öõ tsp', category: 'Baking' },
          { item: 'Vanilla extract', amount: '1 tsp', category: 'Baking' },
          { item: 'Powdered sugar', amount: 'for rolling', category: 'Baking' }
        ],
        directions: [
          'Combine all ingredients except powdered sugar',
          'Refrigerate 30 minutes',
          'Preheat oven to 350¬∞',
          'Roll into balls',
          'Place 1 inch apart on ungreased cookie sheet',
          'Bake 15-20 min (do not brown!)',
          'Let stand 1 min, cool slightly',
          'Roll in powdered sugar while warm',
          'Cool completely'
        ],
        tip: 'Spray Pam on sheet lightly to help with cleanup!'
      },
      {
        id: 'pretzels',
        name: 'Double Dipped Pretzels',
        from: 'Barb Everard',
        preview: 'Long pretzels wrapped in caramel, dipped in chocolate, decorated with toppings. Double boiler needed!',
        ingredients: [
          { item: 'Long pretzels', amount: '3 bags', category: 'Snacks' },
          { item: 'Caramel (Werther\'s chunks)', amount: '2 bags', category: 'Baking' },
          { item: 'Milk chocolate chips', amount: '1 bag', category: 'Baking' },
          { item: 'Toasted almonds', amount: 'for topping', category: 'Nuts' },
          { item: 'Toasted coconut', amount: 'for topping', category: 'Baking' },
          { item: 'Red/white/green sprinkles', amount: 'for topping', category: 'Baking' },
          { item: 'Mixed nuts', amount: 'any type, for topping', category: 'Nuts' }
        ],
        directions: [
          'Cut caramel into tiny slabs',
          'Roll caramel into long length',
          'Wrap caramel around pretzel',
          'Dip in melted chocolate',
          'Decorate with sprinkles, toasted almonds, or nuts',
          'Freeze to set up',
          'Use ribbon at bottom to tie off package'
        ],
        tip: 'Need large bags to package as gifts! Use a double boiler for melting.'
      },
      {
        id: 'oreo-cookies',
        name: 'Homemade Oreo Cookies',
        from: 'Jen Rosen',
        preview: 'Soft devil\'s food cookies with cream cheese filling. Makes 50 cookies! Can sub dark chocolate cake mix.',
        ingredients: [
          { item: "Devil's food cake mix", amount: '2 boxes (can sub dark chocolate)', category: 'Baking' },
          { item: 'Eggs', amount: '4', category: 'Dairy' },
          { item: 'Vegetable oil', amount: '‚Öî cup', category: 'Baking' },
          { item: 'Cream cheese', amount: '4 oz', category: 'Dairy' },
          { item: 'Margarine', amount: '¬Ω cup', category: 'Dairy' },
          { item: 'Powdered sugar', amount: '1¬æ cup', category: 'Baking' },
          { item: 'Vanilla extract', amount: '1 tsp', category: 'Baking' }
        ],
        directions: [
          'Mix first 3 ingredients (cake mix, eggs, oil)',
          'Form into 1 inch balls',
          'Bake at 350¬∞ for 9 minutes',
          'Remove from oven even if they don\'t look done',
          'Mix filling: cream cheese, margarine, powdered sugar, vanilla',
          'Spread on bottom of one cookie, top with another to form sandwich',
          'May use food coloring for holiday colors'
        ],
        tip: 'Use water on hands to roll sticky dough. Use paddle attachment on mixer, NOT dough hook! Cook 8 min for softer cookies.'
      }
    ];

    let selectedRecipes = new Set();

    function renderRecipes() {
      const grid = document.getElementById('recipeGrid');
      grid.innerHTML = recipes.map(recipe => `
        <div class="recipe-card ${selectedRecipes.has(recipe.id) ? 'selected' : ''}" 
             data-id="${recipe.id}">
          <div class="card-header">
            <div>
              <h2>${recipe.name}</h2>
              <div class="from">From ${recipe.from}</div>
            </div>
            <div class="checkbox"></div>
          </div>
          <div class="card-preview">
            <p>${recipe.preview}</p>
            <p class="expand-hint">üëÜ Tap to view full recipe</p>
          </div>
        </div>
      `).join('');

      document.querySelectorAll('.recipe-card').forEach(card => {
        card.addEventListener('click', (e) => {
          const id = card.dataset.id;
          if (e.target.closest('.checkbox')) {
            toggleSelect(id);
          } else {
            openRecipeModal(id);
          }
        });
      });

      updateUI();
    }

    function openRecipeModal(id) {
      const recipe = recipes.find(r => r.id === id);
      if (!recipe) return;
      
      document.getElementById('recipeModalTitle').textContent = recipe.name;
      document.getElementById('recipeModalBody').innerHTML = `
        <p class="from-line">From the kitchen of ${recipe.from}</p>
        
        <h3>üìù Ingredients</h3>
        <ul>
          ${recipe.ingredients.map(i => `<li><strong>${i.amount}</strong> ${i.item}</li>`).join('')}
        </ul>
        
        <h3>üë©‚Äçüç≥ Directions</h3>
        <ol>
          ${recipe.directions.map(d => `<li>${d}</li>`).join('')}
        </ol>
        
        ${recipe.tip ? `<div class="recipe-tip"><strong>üí° Mom's Tip:</strong> ${recipe.tip}</div>` : ''}
      `;
      
      document.getElementById('recipeModalOverlay').classList.add('active');
    }

    function toggleSelect(id) {
      if (selectedRecipes.has(id)) {
        selectedRecipes.delete(id);
      } else {
        selectedRecipes.add(id);
      }
      renderRecipes();
    }

    function updateUI() {
      const count = selectedRecipes.size;
      document.getElementById('selectedCount').textContent = count;
      document.getElementById('shoppingBtn').disabled = count === 0;
      document.getElementById('selectAllBtn').textContent = 
        count === recipes.length ? 'Deselect All' : 'Select All';
    }

    function generateShoppingList() {
      const selected = recipes.filter(r => selectedRecipes.has(r.id));
      const combined = {};

      selected.forEach(recipe => {
        recipe.ingredients.forEach(ing => {
          const key = ing.item.toLowerCase();
          if (!combined[key]) {
            combined[key] = {
              item: ing.item,
              amounts: [],
              category: ing.category,
              recipes: []
            };
          }
          combined[key].amounts.push(ing.amount);
          combined[key].recipes.push(recipe.name);
        });
      });

      // Group by category
      const categories = {};
      Object.values(combined).forEach(item => {
        if (!categories[item.category]) {
          categories[item.category] = [];
        }
        categories[item.category].push(item);
      });

      const modalBody = document.getElementById('modalBody');
      modalBody.innerHTML = `
        <div class="recipes-included">
          <strong>Recipes:</strong> ${selected.map(r => r.name).join(', ')}
        </div>
        ${Object.entries(categories).map(([cat, items]) => `
          <div class="shopping-category">
            <h3>${getCategoryEmoji(cat)} ${cat}</h3>
            ${items.map((item, i) => `
              <div class="shopping-item" data-index="${cat}-${i}">
                <input type="checkbox" id="item-${cat}-${i}">
                <label for="item-${cat}-${i}">
                  <strong>${item.item}</strong><br>
                  <span style="color: #666; font-size: 0.9rem;">${smartCombineAmounts(item.amounts)}</span>
                </label>
                <span class="recipe-tags">${item.recipes.length > 1 ? '(' + item.recipes.join(' + ') + ')' : ''}</span>
              </div>
            `).join('')}
          </div>
        `).join('')}
        <button class="btn btn-secondary print-btn" onclick="window.print()">üñ®Ô∏è Print Shopping List</button>
      `;

      document.querySelectorAll('.shopping-item input').forEach(cb => {
        cb.addEventListener('change', (e) => {
          e.target.closest('.shopping-item').classList.toggle('checked', e.target.checked);
        });
      });

      document.getElementById('modalOverlay').classList.add('active');
    }

    function getCategoryEmoji(cat) {
      const emojis = { 'Dairy': 'üßà', 'Baking': 'ü•£', 'Nuts': 'ü•ú', 'Toppings': 'üç¨' };
      return emojis[cat] || 'üì¶';
    }

    function smartCombineAmounts(amounts) {
      if (amounts.length === 1) return amounts[0];
      // Try to be smart about combining
      return amounts.join(' + ');
    }

    document.getElementById('shoppingBtn').addEventListener('click', generateShoppingList);
    
    document.getElementById('selectAllBtn').addEventListener('click', () => {
      if (selectedRecipes.size === recipes.length) {
        selectedRecipes.clear();
      } else {
        recipes.forEach(r => selectedRecipes.add(r.id));
      }
      renderRecipes();
    });

    document.getElementById('closeModal').addEventListener('click', () => {
      document.getElementById('modalOverlay').classList.remove('active');
    });

    document.getElementById('closeRecipeModal').addEventListener('click', () => {
      document.getElementById('recipeModalOverlay').classList.remove('active');
    });

    document.getElementById('modalOverlay').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) {
        document.getElementById('modalOverlay').classList.remove('active');
      }
    });

    document.getElementById('recipeModalOverlay').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) {
        document.getElementById('recipeModalOverlay').classList.remove('active');
      }
    });

    renderRecipes();
  </script>
</body>
</html>
